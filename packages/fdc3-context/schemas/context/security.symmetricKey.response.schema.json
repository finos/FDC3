{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "$id": "https://fdc3.finos.org/schemas/next/context/symmetricKeyResponse.schema.json",
    "type": "object",
    "title": "Symmetric Key Response",
    "description": "A response containing a wrapped symmetric key and metadata.",
    "allOf": [
        {
            "type": "object",
            "properties": {
                "type": {
                    "const": "fdc3.security.symmetricKey.response"
                },
                "id": {
                    "type": "object",
                    "properties": {
                        "publicKeyUrl": {
                            "type": "string",
                            "format": "uri",
                            "description": "URL pointing to the public key used to wrap the symmetric key."
                        }
                    },
                    "required": [
                        "publicKeyUrl"
                    ]
                },
                "wrappedKey": {
                    "type": "string",
                    "description": "The symmetric key, encrypted using the recipient's public key.",
                    "examples": [
                        "u4jvA7...=="
                    ]
                },
                "algorithm": {
                    "type": "object",
                    "description": "The encryption algorithm parameters used for key wrapping.",
                    "properties": {
                        "name": {
                            "type": "string",
                            "const": "RSA-OAEP",
                            "description": "The algorithm name.",
                            "examples": [
                                "RSA-OAEP"
                            ]
                        },
                        "modulusLength": {
                            "type": "integer",
                            "description": "Length of the RSA key modulus in bits.",
                            "examples": [
                                4096
                            ]
                        },
                        "publicExponent": {
                            "type": "array",
                            "description": "The public exponent used for key generation.",
                            "items": {
                                "type": "integer",
                                "minimum": 0,
                                "maximum": 255
                            },
                            "minItems": 3,
                            "maxItems": 3,
                            "examples": [
                                [
                                    1,
                                    0,
                                    1
                                ]
                            ]
                        },
                        "hash": {
                            "type": "string",
                            "description": "The name of the hash algorithm used with RSA-OAEP.",
                            "enum": [
                                "SHA-256",
                                "SHA-384",
                                "SHA-512"
                            ],
                            "examples": [
                                "SHA-256"
                            ]
                        }
                    },
                    "required": [
                        "name",
                        "modulusLength",
                        "publicExponent",
                        "hash"
                    ]
                }
            },
            "required": [
                "type",
                "id",
                "wrappedKey",
                "algorithm"
            ]
        },
        {
            "$ref": "context.schema.json#/definitions/BaseContext"
        }
    ],
    "examples": [
        {
            "type": "fdc3.security.symmetricKey.response",
            "id": {
                "publicKeyUrl": "https://example.com/keys/public.pem"
            },
            "wrappedKey": "u4jvA7Gx8LdH...==",
            "algorithm": {
                "name": "RSA-OAEP",
                "modulusLength": 4096,
                "publicExponent": [
                    1,
                    0,
                    1
                ],
                "hash": "SHA-256"
            }
        }
    ]
}